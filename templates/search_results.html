<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Results</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        :root {
            --bg-color: #f0f2f5;
            --text-color: #1c1e21;
            --card-bg-color: #fff;
            --border-color: #dddfe2;
            --subtle-text-color: #606770;
            --hover-bg-color: #f5f5f5;
            --switch-bg-color: #ccc;
        }
        [data-theme="dark"] {
            --bg-color: #18191a;
            --text-color: #e4e6eb;
            --card-bg-color: #242526;
            --border-color: #3a3b3c;
            --subtle-text-color: #a8abaf;
            --hover-bg-color: #4e4f50;
            --switch-bg-color: #4e4f50;
        }
        body { 
            background-color: var(--bg-color); 
            color: var(--text-color); 
            transition: background-color 0.3s, color 0.3s; 
        }
        .table {
            background-color: var(--card-bg-color);
            color: var(--text-color);
        }
        .table th, .table td {
            border-color: var(--border-color);
        }
        .btn-primary {
            background-color: #e6464c;
            border-color: #e6464c;
        }
        .switch-container { display: flex; align-items: center; gap: 8px; font-size: 0.9em; font-weight: 600; color: var(--subtle-text-color); white-space: nowrap; margin-bottom: 1rem; }
        .switch { position: relative; display: inline-block; width: 34px; height: 20px; flex-shrink: 0; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--switch-bg-color); transition: .4s; border-radius: 20px; }
        .slider:before { position: absolute; content: ""; height: 12px; width: 12px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: #e6464c; }
        input:checked + .slider:before { transform: translateX(14px); }
        a {
            color: inherit;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        .runner-cell { padding-top: 8px; padding-bottom: 8px; }
        .runner-info { font-weight: 600; font-size: 1em; }
        .sub-info { font-size: 0.85em; color: var(--subtle-text-color); font-weight: 400; padding-top: 4px; display: block; }
    </style>
</head>
<body>
    <div class="container">
        <p class="h5 mt-5">Результаты поиска: "{{ query }}"</p>
        <a href="/" class="btn btn-primary mb-3">Back to Leaderboard</a>
        <div class="switch-container">
            <label class="switch">
                <input type="checkbox" id="themeToggle">
                <span class="slider"></span>
            </label>
            <span>Тёмная тема</span>
        </div>
        
        {% if results %}
            <table class="table">
                <thead>
                    <tr>
                        <th>Участник</th>
                        <th></th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for runner in results %}
                        <tr>
                            <td class="runner-cell">
                                <div class="runner-info"><a href="https://5verst.ru/userstats/{{ runner.id }}/">{{ runner.name }}</a></div>
                                <div class="sub-info">ID: {{ runner.id }}</div>
                            </td>
                            <td>{{ runner.gender }}</td>
                            <td>{{ runner.age_group }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p>No results found.</p>
        {% endif %}
    </div>
    <script>
        const setTheme = (theme) => {
            document.documentElement.dataset.theme = theme;
            localStorage.setItem('theme', theme);
            if (document.getElementById('themeToggle')) {
                document.getElementById('themeToggle').checked = theme === 'dark';
            }
        };

        function initTheme() {
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
            setTheme(savedTheme || (prefersDark ? 'dark' : 'light'));
        }

        document.addEventListener('DOMContentLoaded', () => {
            initTheme();
            document.getElementById('themeToggle').addEventListener('change', (e) => setTheme(e.target.checked ? 'dark' : 'light'));
        });
    </script>
</body>
</html>